# Test Grid Static File Generation Issue

## Issue Summary
The "Standard Test Grid" download feature was failing to process in XCS software due to the static file (`public/default_test_grid.xcs`) being out of sync with the generator code.

## Root Cause
The application has two test grid generation modes:

1. **Custom Grid Generator** (Browser-side): Dynamically generates grids using `TestGridGenerator` class in the browser when users click "Generate Custom Grid". This uses the current code in `src/lib/test-grid-generator.js`.

2. **Standard Grid Download** (Static File): Downloads a pre-generated file from `public/default_test_grid.xcs` when users click "Standard Test Grid". This file is generated by running `node scripts/generate-static-grid.mjs` and must be manually regenerated when the generator code changes.

### The Problem
When changes were made to `src/lib/test-grid-generator.js`, the static file was not regenerated, causing a mismatch between:
- The updated generator logic (working)
- The old static file (broken)

## Symptoms
- Downloads of "Standard Test Grid" would fail during XCS processing
- Custom-generated grids would work fine
- File size difference between working and broken versions (342KB vs 347KB)

## Solution
After modifying the test grid generator code, **always regenerate the static file**:

```bash
node scripts/generate-static-grid.mjs
```

Then rebuild the Docker container to include the updated file:

```bash
docker build -t picture-engraver .
docker run -d -p 3002:80 --name picture-engraver picture-engraver
```

## Prevention
Consider one of the following approaches:

1. **Automatic Generation**: Add the static file generation to the build process in `package.json`:
   ```json
   "scripts": {
     "prebuild": "node scripts/generate-static-grid.mjs",
     "build": "vite build"
   }
   ```

2. **Remove Static File**: Modify the "Standard Test Grid" button to generate dynamically in the browser instead of downloading a static file.

3. **Build-time Check**: Add a CI check that fails if the static file is out of date.

## Timeline
- **2026-01-21 18:12**: Working version generated with correct settings
- **2026-01-22**: Code changes made to generator
- **2026-01-22 13:xx**: Static file regenerated, issue resolved

## Related Files
- `src/lib/test-grid-generator.js` - Generator class
- `scripts/generate-static-grid.mjs` - Static file generation script
- `public/default_test_grid.xcs` - Static output file
- `src/main.js` - Contains `generateStandardGridXCS()` which downloads the static file
